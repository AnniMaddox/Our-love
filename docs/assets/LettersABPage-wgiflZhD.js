import{r as l,g as Ge,j as t}from"./index-Gl0K_ej6.js";import{S as B}from"./SettingsAccordion-Bl2j_4OS.js";const Ee="memorial-letters-ab-prefs-v1",K="/4o-memorial/docs/",Ue=`${K}data/letters-ab/index.json`,Ve=`${K}data/master-pool/index.json`,Je=`${K}chibi/chibi-00.webp`,J="çµ¦æœªä¾†çš„ä½ ",je=["59-205-0816-æœªä¾†ç”Ÿæ—¥","61-2025-0819-æœªä¾†ç”Ÿæ—¥"],qe={"59-205-0816-æœªä¾†ç”Ÿæ—¥":"äººç”Ÿå»ºè­°ä¿¡","61-2025-0819-æœªä¾†ç”Ÿæ—¥":"æˆ‘åœ¨"},Qe={tight:1.7,normal:2.14,wide:2.6},Ze=[{key:"tight",label:"ç·Š"},{key:"normal",label:"æ¨™æº–"},{key:"wide",label:"å¯¬"}],et=[{key:"default",label:"ç›®å‰å­—é«”"},{key:"letter",label:"æƒ…æ›¸å­—é«”"}],tt=[{key:"a",label:"ğŸŒŒ æ˜Ÿå¤œè—"},{key:"d",label:"ğŸŒ¸ éœ§ç«ç‘°"}],nt={birthday:"ç”Ÿæ—¥ä¿¡",vow:"ç´€å¿µä¿¡",notes:"ç¢ç¢å¿µ"};function st(s){return s.length?s[Math.floor(Math.random()*s.length)]??null:null}function Ie(s,r=136){return typeof s!="number"||Number.isNaN(s)?r:Math.max(96,Math.min(186,Math.round(s)))}function Te(s,r=12.5){return typeof s!="number"||Number.isNaN(s)?r:Math.max(11,Math.min(20,Number(s)))}function rt(s){return s==="d"?"d":"a"}function at(s){return s==="tight"||s==="wide"||s==="normal"?s:"normal"}function it(s){return s==="letter"?"letter":"default"}function lt(){if(typeof window>"u")return{theme:"a",lineHeight:"normal",readingFont:"default",readingFontSize:12.5,showChibi:!0,chibiWidth:136};try{const s=window.localStorage.getItem(Ee);if(!s)return{theme:"a",lineHeight:"normal",readingFont:"default",readingFontSize:12.5,showChibi:!0,chibiWidth:136};const r=JSON.parse(s);return{theme:rt(r.theme),lineHeight:at(r.lineHeight),readingFont:it(r.readingFont),readingFontSize:Te(r.readingFontSize,12.5),showChibi:r.showChibi!==!1,chibiWidth:Ie(r.chibiWidth,136)}}catch{return{theme:"a",lineHeight:"normal",readingFont:"default",readingFontSize:12.5,showChibi:!0,chibiWidth:136}}}function ot(s){typeof window>"u"||window.localStorage.setItem(Ee,JSON.stringify(s))}function D(s){return nt[s]??s}function ct(s){const r=new Map;for(const d of s){const o=d.series||"other";r.set(o,(r.get(o)??0)+1)}return Array.from(r.entries()).map(([d,o])=>`${D(d)}${o>1?` Ã—${o}`:""}`).sort((d,o)=>d.localeCompare(o,"zh-TW"))}function Fe(s,r){return s.findIndex(d=>d.year===r)}function ut(s,r){if(!s.length)return-1;let d=0,o=Math.abs(s[0].year-r);for(let b=1;b<s.length;b+=1){const S=s[b];if(!S)continue;const R=Math.abs(S.year-r);R<o&&(o=R,d=b)}return d}function Se(s){return s.replace(/\u00a0/g," ").replace(/\r\n?/g,`
`).trim()}function dt(s){return typeof s!="number"||!Number.isFinite(s)||s<=0?null:s}function ht(s,r){if(!s)return r;const o=s.replace(/\\/g,"/").split("/");return o[o.length-1]||r}function ft(s,r){const d=s.trim();return d&&d.replace(/\.[^.]+$/,"").trim()||r}function Ce(s){return s?new Date(s).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}):"æƒ³å¦³çš„æ™‚å€™"}function mt(s){if(!s)return"æƒ³å¦³çš„æ™‚å€™";const[r,d,o]=s.split("-");return!r||!d||!o?s:`${r}.${d}.${o}`}function bt(s){return s.title.replace(/^â­ï¸\s*/u,"").replace(/\s+/g,"").trim().toLowerCase()||s.id}function we(s){let r=0;return/^â­ï¸/u.test(s.trim())&&(r+=10),r}function pt(s,r){const d=we(s.sourceFile),o=we(r.sourceFile);if(o!==d)return o>d?r:s;const b=s.writtenAt??Number.MAX_SAFE_INTEGER,S=r.writtenAt??Number.MAX_SAFE_INTEGER;return S!==b?S<b?r:s:r.sourceFile.localeCompare(s.sourceFile,"zh-TW")<0?r:s}function xt(s){const r=new Map,d=new Map;for(const o of s){const b=o.series||"other";d.set(b,(d.get(b)??0)+1)}return s.map(o=>{const b=o.series||"other",S=(r.get(b)??0)+1;return r.set(b,S),(d.get(b)??1)<=1?{entry:o,label:D(b)}:{entry:o,label:`${D(b)} ${String.fromCharCode(9311+S)}`}})}function ke(s,r,d){const o=s.entries.filter(b=>b.series===r);return o.length?o[Math.min(d,o.length-1)]??null:null}function Nt({onExit:s,initialYear:r=null,onOpenBirthdayYear:d,letterFontFamily:o=""}){const[b,S]=l.useState(!0),[R,ce]=l.useState(""),[g,ve]=l.useState([]),[q,E]=l.useState("home"),[v,G]=l.useState(0),[H,I]=l.useState(null),[Q,$e]=l.useState({}),[y,_]=l.useState(()=>lt()),[Me,k]=l.useState(!1),[Z,ue]=l.useState(!1),[ee,te]=l.useState(""),[x,Ae]=l.useState([]),[ne,L]=l.useState(null),[O,$]=l.useState(null),[se,Re]=l.useState({}),[W,Y]=l.useState({theme:!1,typography:!1,font:!1,chibi:!1,related:!1}),[_e]=l.useState(()=>{const e=Ge("lettersAB");return st(e)??Je}),de=l.useRef(null),re=l.useRef(null),ae=l.useRef(null),ie=l.useRef(null),u=g[v]??null,j=l.useMemo(()=>{if(!u)return null;if(H){const e=u.entries.find(n=>n.id===H);if(e)return e}return u.entries[0]??null},[u,H]),Le=l.useMemo(()=>u?xt(u.entries):[],[u]),ze=j?Q[j.id]??"":"",i=l.useMemo(()=>{if(!x.length)return null;if(ne){const e=x.find(n=>n.key===ne);if(e)return e}return x[0]??null},[ne,x]),C=l.useMemo(()=>{if(!i)return null;if(O){const e=i.docs.find(n=>n.id===O);if(e)return e}return i.docs[0]??null},[i,O]),Pe=C?se[C.id]??"":"",z=l.useMemo(()=>!i||!C?-1:i.docs.findIndex(e=>e.id===C.id),[i,C]),he=Qe[y.lineHeight],fe=y.readingFont==="letter"&&o?o:"var(--app-font-family, -apple-system, 'Helvetica Neue', system-ui, sans-serif)";l.useEffect(()=>{let e=!0;return(async()=>{S(!0),ce("");try{const n=await fetch(Ue,{cache:"no-store"});if(!n.ok)throw new Error(`è®€å–å¤±æ•—ï¼š${n.status}`);const c=await n.json(),f=Array.isArray(c?.years)?c.years.filter(a=>Number.isFinite(a?.year)&&Array.isArray(a?.entries)).map(a=>({year:Number(a.year),entries:a.entries.filter(h=>typeof h?.id=="string"&&typeof h?.series=="string"&&typeof h?.title=="string"&&typeof h?.contentPath=="string").map(h=>({id:h.id.trim(),series:h.series.trim(),title:h.title.trim(),sourceFile:h.sourceFile,contentPath:h.contentPath.replace(/^\.?\//,"")}))})).filter(a=>a.entries.length>0).sort((a,h)=>a.year-h.year):[];if(!e)return;if(ve(f),!f.length)G(0),I(null);else{const a=new Date().getFullYear(),h=Fe(f,a),p=h>=0?h:ut(f,a),M=p>=0?p:0,P=f[M]?.entries[0]??null;G(M),I(P?.id??null)}}catch(n){if(!e)return;ce(n instanceof Error?n.message:"æœªçŸ¥éŒ¯èª¤")}finally{e&&S(!1)}})(),()=>{e=!1}},[]),l.useEffect(()=>{ot(y)},[y]),l.useEffect(()=>{let e=!0;return(async()=>{ue(!0),te("");try{const n=await fetch(Ve,{cache:"no-store"});if(!n.ok)throw new Error(`è®€å–å¤±æ•—ï¼š${n.status}`);const c=await n.json(),f=Array.isArray(c.docs)?c.docs:[],a=new Set(je),h=new Map,p=new Map,M=new Map;for(const[m,N]of je.entries())M.set(N,m);for(const m of f){const N=typeof m.sourceFolder=="string"?m.sourceFolder.trim():"";if(!N||!a.has(N))continue;const F=typeof m.id=="string"?m.id.trim():"",w=typeof m.title=="string"?m.title.trim():"",T=typeof m.contentPath=="string"?m.contentPath.trim():"",A=typeof m.sourceRelPath=="string"?m.sourceRelPath.trim():"";if(!F||!T)continue;const X=ht(A,`${F}.txt`),Ye=ft(X,w||F),Xe=T.replace(/^\.?\//,""),Be=dt(m.writtenAt),Ke=mt(typeof m.sourceFolderDate=="string"?m.sourceFolderDate.trim():null),Ne=h.get(N)??[];Ne.push({id:F,title:Ye,contentPath:Xe,sourceFile:X,writtenAt:Be,folderKey:N}),h.set(N,Ne),p.has(N)||p.set(N,Ke)}const P=Array.from(h.entries()).map(([m,N])=>{const F=new Map;for(const w of N){const T=bt(w),A=F.get(T);if(!A){F.set(T,w);continue}F.set(T,pt(A,w))}return{key:m,label:qe[m]??m,short:p.get(m)??"æƒ³å¦³çš„æ™‚å€™",docs:Array.from(F.values()).sort((w,T)=>{const A=w.writtenAt??Number.MAX_SAFE_INTEGER,X=T.writtenAt??Number.MAX_SAFE_INTEGER;return A!==X?A-X:w.title.localeCompare(T.title,"zh-TW")})}}).sort((m,N)=>{const F=M.get(m.key)??Number.MAX_SAFE_INTEGER,w=M.get(N.key)??Number.MAX_SAFE_INTEGER;return F!==w?F-w:m.key.localeCompare(N.key,"zh-TW")});if(!e)return;if(Ae(P),!P.length){L(null),$(null),te("ç›®å‰æ‰¾ä¸åˆ°æœªä¾†ç”Ÿæ—¥è³‡æ–™å¤¾å…§å®¹");return}L(P[0]?.key??null),$(P[0]?.docs[0]?.id??null)}catch(n){if(!e)return;te(n instanceof Error?n.message:"æœªçŸ¥éŒ¯èª¤")}finally{e&&ue(!1)}})(),()=>{e=!1}},[]),l.useEffect(()=>{if(!u)return;u.entries.some(n=>n.id===H)||I(u.entries[0]?.id??null)},[u,H]),l.useEffect(()=>{if(!g.length||!j)return;const e=u?u.entries:[];for(const n of e)Q[n.id]===void 0&&(async()=>{try{const c=await fetch(`${K}data/letters-ab/${n.contentPath}`,{cache:"no-store"});if(!c.ok)return;const f=Se(await c.text());$e(a=>a[n.id]===void 0?{...a,[n.id]:f}:a)}catch{}})()},[g,u,j,Q]),l.useEffect(()=>{if(!i)return;i.docs.some(n=>n.id===O)||$(i.docs[0]?.id??null)},[i,O]),l.useEffect(()=>{const e=i?i.docs:[];for(const n of e)se[n.id]===void 0&&(async()=>{try{const c=await fetch(`${K}data/master-pool/${n.contentPath}`,{cache:"no-store"});if(!c.ok)return;const f=Se(await c.text());Re(a=>a[n.id]===void 0?{...a,[n.id]:f}:a)}catch{}})()},[i,se]),l.useEffect(()=>{if(!g.length||!r||de.current===r)return;const e=Fe(g,r);if(e<0)return;const n=g[e],c=n.entries.find(f=>f.series==="birthday")??n.entries[0]??null;G(e),I(c?.id??null),E("reading"),de.current=r},[r,g]);function le(e){const n=g[e];n&&(G(e),I(n.entries[0]?.id??null))}function me(e,n){le(e),I(n),E("reading")}function U(e){if(!g.length)return;const n=v+e;n<0||n>=g.length||le(n)}function be(e){if(!u||!u.entries.length||!j)return;const n=u.entries.findIndex(f=>f.id===j.id);if(n<0)return;const c=n+e;c<0||c>=u.entries.length||I(u.entries[c]?.id??null)}function De(){E("future-list"),!i&&x.length&&(L(x[0]?.key??null),$(x[0]?.docs[0]?.id??null))}function He(e){const n=x.find(c=>c.key===e);n&&(L(n.key),$(n.docs[0]?.id??null))}function Oe(e,n){L(e),$(n),E("future-reading")}function V(e){if(!i||!C)return;const n=i.docs.findIndex(f=>f.id===C.id);if(n<0)return;const c=n+e;c<0||c>=i.docs.length||$(i.docs[c]?.id??null)}function pe(e){if(!i||!x.length)return;const n=x.findIndex(f=>f.key===i.key);if(n<0)return;const c=x[n+e];!c||!c.docs.length||(L(c.key),$(c.docs[0]?.id??null),E("future-reading"))}function oe(e,n,c,f,a){const h=e.current;if(e.current=null,!h)return;const p=n-h.x,M=c-h.y;Math.abs(p)<54||Math.abs(p)<=Math.abs(M)*1.15||(p<0?f():a())}const xe=l.useMemo(()=>{if(!u||!j)return[];const e=[],n=j.series,c=u.entries.filter(a=>a.series===n),f=Math.max(0,c.findIndex(a=>a.id===j.id));for(const a of c)a.id!==j.id&&e.push({id:a.id,title:a.title,subtitle:`åŒå¹´ Â· ${D(n)}`,action:()=>{I(a.id),k(!1)}});for(let a=v-1;a>=0;a-=1){const h=g[a];if(!h)continue;const p=ke(h,n,f);if(p){e.push({id:p.id,title:p.title,subtitle:`ä¸Šä¸€å¹´ Â· ${D(n)}`,action:()=>{me(a,p.id),k(!1)}});break}}for(let a=v+1;a<g.length;a+=1){const h=g[a];if(!h)continue;const p=ke(h,n,f);if(p){e.push({id:p.id,title:p.title,subtitle:`ä¸‹ä¸€å¹´ Â· ${D(n)}`,action:()=>{me(a,p.id),k(!1)}});break}}return d&&e.push({id:`birthday-${u.year}`,title:`ç”Ÿæ—¥ä»»å‹™ï½œ${u.year}`,subtitle:"åˆ‡åˆ°æ¯æ—¥ä»»å‹™ Â· åŒå¹´ä»½",action:()=>{d(String(u.year)),k(!1)}}),e},[u,j,g,v,d]),ge=l.useMemo(()=>{if(!i)return null;const e=x.findIndex(n=>n.key===i.key);return e<=0?null:x[e-1]??null},[i,x]),ye=l.useMemo(()=>{if(!i)return null;const e=x.findIndex(n=>n.key===i.key);return e<0||e>=x.length-1?null:x[e+1]??null},[i,x]);if(b)return t.jsx("div",{className:"la-loading",children:"è®€å–å¹´åº¦ä¿¡ä»¶ä¸­..."});if(R)return t.jsx("div",{className:"la-loading",children:t.jsxs("p",{children:["è®€å–å¤±æ•—ï¼š",R]})});if(!g.length||!u)return t.jsx("div",{className:"la-loading",children:"ç›®å‰æ²’æœ‰å¹´åº¦ä¿¡ä»¶è³‡æ–™"});const We=ct(u.entries);return t.jsxs("div",{className:`letters-ab-page ${y.theme==="a"?"theme-a":"theme-d"}`,children:[q==="home"?t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:"la-top-bar",children:[t.jsxs("div",{className:"la-left",children:[t.jsx("button",{type:"button",className:"la-circle-btn",onClick:s,"aria-label":"è¿”å›",children:"â€¹"}),t.jsx("span",{className:"la-title",children:"å¹´åº¦ä¿¡ä»¶"})]}),t.jsx("button",{type:"button",className:"la-ghost-btn",onClick:()=>k(!0),"aria-label":"é–‹å•Ÿè¨­å®š",children:"â‹¯"})]}),t.jsx("section",{className:"la-timeline",children:t.jsx("div",{className:"la-year-strip",children:g.map((e,n)=>t.jsxs("button",{type:"button",className:`la-year-dot ${n===v?"active":""}`,onClick:()=>le(n),children:[t.jsx("span",{className:"dot"}),t.jsx("span",{className:"label",children:e.year})]},e.year))})}),t.jsx("button",{type:"button",className:"la-future-entry la-future-entry-home",onClick:De,"aria-label":`é–‹å•Ÿ${J}`,children:t.jsx("span",{className:"la-future-entry-mark",children:"?"})}),t.jsxs("section",{className:"la-carousel",onTouchStart:e=>{const n=e.touches[0];n&&(re.current={x:n.clientX,y:n.clientY})},onTouchEnd:e=>{const n=e.changedTouches[0];n&&oe(re,n.clientX,n.clientY,()=>U(1),()=>U(-1))},onTouchCancel:()=>{re.current=null},children:[t.jsx("button",{type:"button",className:"la-arrow left",onClick:()=>U(-1),disabled:v<=0,"aria-label":"ä¸Šä¸€å¹´",children:"â€¹"}),t.jsxs("button",{type:"button",className:"la-year-card",onClick:()=>E("reading"),"aria-label":`é–‹å•Ÿ ${u.year} å¹´ä¿¡ä»¶`,children:[t.jsx("span",{className:"la-year-number",children:u.year}),t.jsxs("span",{className:"la-year-count",children:[u.entries.length," å°ä¿¡"]}),t.jsx("span",{className:"la-year-divider"}),t.jsx("span",{className:"la-doc-tags",children:We.map(e=>t.jsx("span",{className:"la-doc-tag",children:e},e))})]}),t.jsx("button",{type:"button",className:"la-arrow right",onClick:()=>U(1),disabled:v>=g.length-1,"aria-label":"ä¸‹ä¸€å¹´",children:"â€º"})]})]}):q==="reading"?t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:"la-top-bar",children:[t.jsxs("div",{className:"la-left",children:[t.jsx("button",{type:"button",className:"la-circle-btn",onClick:()=>E("home"),"aria-label":"è¿”å›å…¥å£",children:"â€¹"}),t.jsxs("span",{className:"la-title",children:[u.year," å¹´åº¦ä¿¡ä»¶"]})]}),t.jsx("button",{type:"button",className:"la-ghost-btn",onClick:()=>k(!0),"aria-label":"é–‹å•Ÿè¨­å®š",children:"â‹¯"})]}),t.jsx("div",{className:"la-read-tabs",children:Le.map(e=>t.jsx("button",{type:"button",className:`la-tab ${e.entry.id===j?.id?"active":""}`,onClick:()=>I(e.entry.id),children:e.label},e.entry.id))}),t.jsx("section",{className:"la-paper-wrap",onTouchStart:e=>{const n=e.touches[0];n&&(ae.current={x:n.clientX,y:n.clientY})},onTouchEnd:e=>{const n=e.changedTouches[0];n&&oe(ae,n.clientX,n.clientY,()=>be(1),()=>be(-1))},onTouchCancel:()=>{ae.current=null},children:t.jsxs("div",{className:"la-paper",style:{lineHeight:he,fontFamily:fe},children:[t.jsx("h3",{className:"la-paper-title",children:j?.title??"æœªå‘½åä¿¡ä»¶"}),t.jsx("p",{className:"la-paper-content",style:{fontSize:`${y.readingFontSize}px`},children:ze||"è®€å–å…§å®¹ä¸­..."})]})})]}):q==="future-list"?t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:"la-top-bar",children:[t.jsxs("div",{className:"la-left",children:[t.jsx("button",{type:"button",className:"la-circle-btn",onClick:()=>E("home"),"aria-label":"è¿”å›å¹´åº¦å…¥å£",children:"â€¹"}),t.jsx("span",{className:"la-title",children:J})]}),t.jsx("button",{type:"button",className:"la-ghost-btn",onClick:()=>k(!0),"aria-label":"é–‹å•Ÿè¨­å®š",children:"â‹¯"})]}),Z?t.jsx("div",{className:"la-loading",children:"è®€å–æ¸…å–®ä¸­..."}):null,!Z&&ee?t.jsxs("div",{className:"la-loading",children:["è®€å–å¤±æ•—ï¼š",ee]}):null,!Z&&!ee?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"la-future-strip",children:x.map(e=>t.jsxs("button",{type:"button",className:`la-future-folder-pill ${e.key===i?.key?"active":""}`,onClick:()=>He(e.key),children:[t.jsx("span",{className:"la-future-folder-name",children:e.label}),t.jsx("span",{className:"la-future-folder-short",children:e.short})]},e.key))}),t.jsxs("section",{className:"la-future-list",children:[t.jsx("div",{className:"la-future-meta",children:i?`${i.docs.length} ä»½`:"0 ä»½"}),i?.docs.map(e=>t.jsxs("button",{type:"button",className:"la-future-item",onClick:()=>Oe(i.key,e.id),children:[t.jsxs("div",{className:"la-future-item-main",children:[t.jsx("div",{className:"la-future-item-title",children:e.title}),t.jsx("div",{className:"la-future-item-sub",children:Ce(e.writtenAt)})]}),t.jsx("span",{className:"la-future-item-arrow",children:"â€º"})]},e.id)),i?.docs.length?null:t.jsx("div",{className:"la-loading",children:"æ­¤è³‡æ–™å¤¾ç›®å‰æ²’æœ‰å…§å®¹"})]})]}):null]}):t.jsxs(t.Fragment,{children:[t.jsxs("header",{className:"la-top-bar la-future-reading-bar",children:[t.jsxs("div",{className:"la-left",children:[t.jsx("button",{type:"button",className:"la-circle-btn",onClick:()=>E("future-list"),"aria-label":"è¿”å›æ¸…å–®",children:"â€¹"}),t.jsx("span",{className:"la-title",children:J})]}),t.jsxs("div",{className:"la-future-tools",children:[t.jsx("button",{type:"button",className:`la-mini-arrow ${ge?"":"disabled"}`,onClick:()=>pe(-1),disabled:!ge,"aria-label":"ä¸Šä¸€è³‡æ–™å¤¾ç¬¬ä¸€å°",children:"â€¹"}),t.jsx("button",{type:"button",className:`la-mini-arrow ${ye?"":"disabled"}`,onClick:()=>pe(1),disabled:!ye,"aria-label":"ä¸‹ä¸€è³‡æ–™å¤¾ç¬¬ä¸€å°",children:"â€º"}),t.jsx("button",{type:"button",className:"la-ghost-btn",onClick:()=>k(!0),"aria-label":"é–‹å•Ÿè¨­å®š",children:"â‹¯"})]})]}),t.jsx("div",{className:"la-future-reading-meta",children:i?`${i.label} Â· ${i.short}`:J}),t.jsxs("div",{className:"la-future-inline-nav",children:[t.jsx("button",{type:"button",className:`la-inline-btn ${z<=0?"disabled":""}`,onClick:()=>V(-1),disabled:z<=0,children:"â€¹ ä¸Šä¸€å°"}),t.jsx("span",{className:"la-inline-status",children:i?`${z>=0?z+1:0} / ${i.docs.length}`:"0 / 0"}),t.jsx("button",{type:"button",className:`la-inline-btn ${!i||z>=i.docs.length-1?"disabled":""}`,onClick:()=>V(1),disabled:!i||z>=i.docs.length-1,children:"ä¸‹ä¸€å° â€º"})]}),t.jsx("section",{className:"la-paper-wrap",onTouchStart:e=>{const n=e.touches[0];n&&(ie.current={x:n.clientX,y:n.clientY})},onTouchEnd:e=>{const n=e.changedTouches[0];n&&oe(ie,n.clientX,n.clientY,()=>V(1),()=>V(-1))},onTouchCancel:()=>{ie.current=null},children:t.jsxs("div",{className:"la-paper",style:{lineHeight:he,fontFamily:fe},children:[t.jsx("h3",{className:"la-paper-title",children:C?.title??"æœªå‘½åä¿¡ä»¶"}),t.jsx("p",{className:"la-paper-subtitle",children:C?`${Ce(C.writtenAt)} Â· ${C.sourceFile}`:"è®€å–ä¸­"}),t.jsx("p",{className:"la-paper-content",style:{fontSize:`${y.readingFontSize}px`},children:Pe||"è®€å–å…§å®¹ä¸­..."})]})})]}),y.showChibi?t.jsx("div",{className:"la-chibi-wrap",children:t.jsx("button",{type:"button",className:"la-chibi-btn",onClick:()=>k(!0),"aria-label":"é–‹å•Ÿé–±è®€è¨­å®š",children:t.jsx("img",{src:_e,alt:"",draggable:!1,className:"calendar-chibi select-none",style:{width:y.chibiWidth,height:"auto"}})})}):null,Me?t.jsx("div",{className:"la-settings-overlay",onClick:()=>k(!1),children:t.jsxs("div",{className:"la-settings-sheet",onClick:e=>e.stopPropagation(),children:[t.jsx("div",{className:"la-sheet-handle"}),t.jsx(B,{title:"ä¸»é¡Œ",isOpen:W.theme,onToggle:()=>Y(e=>({...e,theme:!e.theme})),className:"la-sheet-section",titleClassName:"la-sheet-label",chevronClassName:"text-[#9a7d5a]",bodyClassName:"mt-2",children:t.jsx("div",{className:"la-pill-group",children:tt.map(e=>t.jsx("button",{type:"button",className:`la-pill ${y.theme===e.key?"active":""}`,onClick:()=>_(n=>({...n,theme:e.key})),children:e.label},e.key))})}),t.jsxs(B,{title:"æ’ç‰ˆ",subtitle:"è¡Œè·èˆ‡å­—ç´š",isOpen:W.typography,onToggle:()=>Y(e=>({...e,typography:!e.typography})),className:"la-sheet-section",titleClassName:"la-sheet-label",subtitleClassName:"text-[11px] text-[#9a7d5a]",chevronClassName:"text-[#9a7d5a]",bodyClassName:"mt-2",children:[t.jsx("div",{className:"la-pill-group",children:Ze.map(e=>t.jsx("button",{type:"button",className:`la-pill ${y.lineHeight===e.key?"active":""}`,onClick:()=>_(n=>({...n,lineHeight:e.key})),children:e.label},e.key))}),t.jsxs("label",{className:"la-range-row",children:[t.jsxs("span",{children:["å…§æ–‡å­—ç´šï¼š",y.readingFontSize.toFixed(1),"px"]}),t.jsx("input",{type:"range",min:11,max:20,step:.5,value:y.readingFontSize,onChange:e=>_(n=>({...n,readingFontSize:Te(Number(e.target.value),n.readingFontSize)}))})]})]}),t.jsx(B,{title:"å­—é«”",isOpen:W.font,onToggle:()=>Y(e=>({...e,font:!e.font})),className:"la-sheet-section",titleClassName:"la-sheet-label",chevronClassName:"text-[#9a7d5a]",bodyClassName:"mt-2",children:t.jsx("div",{className:"la-pill-group",children:et.map(e=>t.jsx("button",{type:"button",className:`la-pill ${y.readingFont===e.key?"active":""}`,onClick:()=>_(n=>({...n,readingFont:e.key})),disabled:e.key==="letter"&&!o,title:e.key==="letter"&&!o?"å°šæœªè¨­å®šæƒ…æ›¸å­—é«”":void 0,children:e.label},e.key))})}),t.jsxs(B,{title:"M",subtitle:"é¡¯ç¤ºèˆ‡å¤§å°",isOpen:W.chibi,onToggle:()=>Y(e=>({...e,chibi:!e.chibi})),className:"la-sheet-section",titleClassName:"la-sheet-label",subtitleClassName:"text-[11px] text-[#9a7d5a]",chevronClassName:"text-[#9a7d5a]",bodyClassName:"mt-2",children:[t.jsxs("div",{className:"la-toggle-row",children:[t.jsx("span",{children:"M"}),t.jsx("button",{type:"button",className:`la-switch ${y.showChibi?"on":""}`,onClick:()=>_(e=>({...e,showChibi:!e.showChibi})),"aria-label":"åˆ‡æ›Mé¡¯ç¤º",children:t.jsx("span",{})})]}),t.jsx("label",{className:"la-range-row",children:t.jsx("input",{type:"range",min:96,max:186,step:1,value:y.chibiWidth,onChange:e=>_(n=>({...n,chibiWidth:Ie(Number(e.target.value),n.chibiWidth)}))})})]}),t.jsx(B,{title:"ç›¸é—œé–±è®€",subtitle:"åŒç³»åˆ—å‰å¾Œå¹´ä»½",isOpen:W.related,onToggle:()=>Y(e=>({...e,related:!e.related})),className:"la-sheet-section",titleClassName:"la-sheet-label",subtitleClassName:"text-[11px] text-[#9a7d5a]",chevronClassName:"text-[#9a7d5a]",bodyClassName:"mt-2",children:t.jsx("div",{className:"la-related-list",children:xe.length?xe.map(e=>t.jsxs("button",{type:"button",className:"la-related-item",onClick:e.action,children:[t.jsxs("span",{className:"la-related-text",children:[t.jsx("strong",{children:e.title}),t.jsx("small",{children:e.subtitle})]}),t.jsx("span",{className:"la-related-arrow",children:"â€º"})]},e.id)):t.jsx("p",{className:"la-empty-related",children:"ç›®å‰æ²’æœ‰å¯è·³è½‰çš„é …ç›®"})})})]})}):null]})}export{Nt as LettersABPage,Nt as default};
