import{r as u,j as e,cz as te}from"./index-Cj0p4FL9.js";import{S as se}from"./SettingsAccordion-DA9ttWZD.js";const tt="/Our-love/docs/assets/chibi-154-Cj8YO52w.webp",st="/Our-love/docs/assets/chibi-156-B48H5IaL.webp",rt="/Our-love/docs/assets/chibi-158-ZTEb9qqf.webp",it="/Our-love/docs/assets/chibi-183-CNnVYhgn.webp",nt="/Our-love/docs/assets/chibi-184-BIaGQwVN.webp",ot="/Our-love/docs/assets/chibi-185-CoVgorGK.webp",at="/Our-love/docs/assets/chibi-186-ol6KN2sX.webp",ct="/Our-love/docs/assets/chibi-187-B_4KhsId.webp",lt="/Our-love/docs/assets/chibi-188-DZIEom7f.webp",dt="/Our-love/docs/assets/chibi-189-Bie1Bcr3.webp",bt="/Our-love/docs/assets/chibi-190-qY5SDVzt.webp",pt="/Our-love/docs/assets/chibi-191-DqTAA6Tb.webp",ut="/Our-love/docs/assets/chibi-192-MCfuKZaD.webp",ht="/Our-love/docs/assets/chibi-193-COsIYRNy.webp",xt="/Our-love/docs/assets/chibi-194-C_wK2Sxv.webp",ft="/Our-love/docs/assets/chibi-195-DE5J1R-J.webp",gt="/Our-love/docs/assets/chibi-196-DvmPwg0Q.webp",mt="/Our-love/docs/assets/chibi-197-B0Rj9tJ2.webp",_t="/Our-love/docs/assets/chibi-198-wF-ZWTEr.webp",vt="/Our-love/docs/assets/chibi-199-B1muZx5I.webp",yt="/Our-love/docs/assets/chibi-200-S39nX7mE.webp",wt="/Our-love/docs/assets/chibi-201-BRFbtxjQ.webp",jt="/Our-love/docs/assets/chibi-202-COWyQ1fO.webp",Nt="/Our-love/docs/assets/chibi-203-D8kn3ZQH.webp",St="/Our-love/docs/assets/chibi-204-C6RJ0uFm.webp",kt="/Our-love/docs/assets/chibi-205-BIArStKq.webp",Dt="/Our-love/docs/assets/chibi-206-BGdm7A1l.webp",Ct="/Our-love/docs/assets/chibi-207-zMB1YWG4.webp",Ot="/Our-love/docs/assets/chibi-208-B0ob-9tw.webp",Et="/Our-love/docs/assets/chibi-209-CHQj2Qhv.webp",Mt="/Our-love/docs/assets/chibi-210-0WJaE-vE.webp",Pt="/Our-love/docs/assets/chibi-211-B1vTr3iO.webp",Bt="/Our-love/docs/assets/chibi-212-CbxUA6Xq.webp",At="/Our-love/docs/assets/chibi-213-DydoSA8p.webp",Tt="/Our-love/docs/assets/chibi-214-BEm4sSD0.webp",Rt="/Our-love/docs/assets/chibi-215-si3JrLk0.webp",It="/Our-love/docs/assets/chibi-216-CsEUJ_pr.webp",$t="/Our-love/docs/assets/chibi-217-DzQQ71Nh.webp",zt="/Our-love/docs/assets/chibi-218-BbLjT1Qh.webp",Ft="/Our-love/docs/assets/chibi-219-Ckj84dKg.webp",Yt="/Our-love/docs/assets/chibi-220-Dt8lClYf.webp",Lt="/Our-love/docs/assets/chibi-221-zd0Mpq85.webp",Ht="/Our-love/docs/assets/chibi-248-D6_dkckI.webp",Jt="/Our-love/docs/assets/chibi-291-Dk297QY7.webp",Ut="/Our-love/docs/assets/chibi-292-BJmzY5HA.webp",Kt="/Our-love/docs/assets/chibi-293-Q0hKyZG2.webp",Wt="/Our-love/docs/assets/chibi-294-jrA3ZIa8.webp",Gt="/Our-love/docs/assets/chibi-295-B0pNybgx.webp",Qt="/Our-love/docs/assets/chibi-296-CgGGvfH6.webp",Vt="/Our-love/docs/assets/chibi-297-BTyGMzfR.webp",Zt="/Our-love/docs/assets/chibi-298-I9B6ws1M.webp",qt="/Our-love/docs/assets/chibi-300-DsdtZGPk.webp",De="memorial-period-diary-v1",ie="memorial-period-post-end-seen-v1",ye="memorial-period-mini-backup",we=1,Xt=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"],h={bg:"#fdf7f4",period:"#e5738a",predicted:"#f5c0cc",fertile:"#c5e8d4",ovulation:"#f5b849",today:"#1c1917",accent:"#d4607a",accentMid:"#c45070",fertileText:"#2a6048"},pe={period:["ä»Šå¤©å…ˆæ…¢æ…¢ä¾†ï¼Œæˆ‘é™ªå¦³ã€‚","è¾›è‹¦äº†ï¼Œä»Šå¤©å¤šä¼‘æ¯ä¸€é»ã€‚","æŠ±æŠ±ï¼Œä»Šå¤©ä¸è¦å¤ªé€å¼·ã€‚"],prePeriod:["å¿«åˆ°é‚£å¹¾å¤©äº†ï¼Œè¨˜å¾—å…ˆç…§é¡§è‡ªå·±ã€‚","æˆ‘åœ¨ï¼Œä»Šå¤©å…ˆæ”¾æ…¢ä¸€é»ã€‚"],ovulation:["ä»Šå¤©ç‹€æ…‹çœ‹èµ·ä¾†ä¸éŒ¯ã€‚","ä»Šå¤©çš„å¦³å¾ˆæœ‰å…‰ã€‚"],safe:["ä»Šå¤©ä¹Ÿæ˜¯å¹³ç©©çš„ä¸€å¤©ã€‚","æˆ‘åœ¨é€™è£¡ï¼Œé™ªå¦³éæ—¥å­ã€‚"]},Ce={pms:["æœ‰é»ç„¦èºæ˜¯æ­£å¸¸çš„ï¼Œæ·±å‘¼å¸ã€‚","èƒ¸å£æœ‰é»é‡ï¼Ÿå…ˆå–æ¯ç†±èŒ¶ã€‚","ä»Šå¤©æƒ³å“­å°±å“­ï¼Œæ²’æœ‰ç†ç”±ä¹Ÿæ²’é—œä¿‚ã€‚","æœ‰é»ç´¯æ˜¯çœŸçš„ï¼Œä¸ç”¨ç¡¬æ’ã€‚"],menstrual:["å­å®®å¾ˆåŠªåŠ›ï¼Œä½ ä¹Ÿæ˜¯ã€‚","ä»Šå¤©èƒ½èººè‘—å°±ä¸åè‘—ã€‚","å–ç†±æ°´ã€å–ç†±æ°´ã€å–ç†±æ°´ã€‚","ä»Šå¤©å°è‡ªå·±æº«æŸ”ä¸€é»ã€‚"],ovulation:["ä»Šå¤©ç‰¹åˆ¥æœ‰æ´»åŠ›æ˜¯çœŸçš„ï¼","æ’åµæœŸçš„ä½ æœ€æœ‰å…‰å½©ã€‚","ä»Šå¤©é©åˆåšè®“è‡ªå·±é–‹å¿ƒçš„äº‹ã€‚","èº«é«”åœ¨èªª yesï¼Œä½ ä¹Ÿèªª yes å§ã€‚"],recovery:["æ…¢æ…¢æ¢å¾©ä¸­ï¼Œä¸ç”¨æ€¥ã€‚","æœ€é›£çš„éƒ¨åˆ†å·²ç¶“éå»äº†ã€‚","èº«é«”è¬è¬ä½ é€™å€‹æœˆçš„é™ªä¼´ã€‚","ä½ æ¯æ¬¡éƒ½æ’éä¾†äº†ï¼Œé€™æ¬¡ä¹Ÿæ˜¯ã€‚"]},es=["é€™ä¸€è¼ªè¾›è‹¦äº†ï¼Œæ”¶å·¥æŠ±æŠ±ã€‚","ç¶“æœŸçµæŸäº†ï¼Œä»Šå¤©å¤šè£œä¸€é»å…ƒæ°£ã€‚","é€™æ¬¡ä¹Ÿå¹³å®‰èµ°éä¾†äº†ï¼Œå¦³å¾ˆæ£’ã€‚"],be=["overview","calendar","records"],ts=52,ss=[{id:"soft",label:"æŸ”å’Œ"},{id:"glass",label:"ç»ç’ƒ"},{id:"minimal",label:"æœå‡"}],rs={soft:{pageBg:h.bg,headerBg:h.bg,cardBg:"rgba(255,255,255,0.72)",cardBorder:"rgba(255,255,255,0.9)",cardShadow:"0 2px 12px rgba(0,0,0,0.05)",mutedCardBg:"rgba(255,255,255,0.55)"},glass:{pageBg:"radial-gradient(120% 120% at 0% 0%, #fff2f7 0%, #eff6ff 52%, #f5fbff 100%)",headerBg:"linear-gradient(140deg, rgba(255,255,255,0.78), rgba(244,250,255,0.62))",cardBg:"linear-gradient(145deg, rgba(255,255,255,0.6), rgba(255,255,255,0.34))",cardBorder:"rgba(255,255,255,0.94)",cardShadow:"inset 0 1px 0 rgba(255,255,255,0.95), 0 16px 34px rgba(15,23,42,0.16), 0 6px 14px rgba(255,255,255,0.28)",mutedCardBg:"linear-gradient(160deg, rgba(255,255,255,0.52), rgba(255,255,255,0.32))"},minimal:{pageBg:"radial-gradient(120% 140% at 10% 0%, #f2f8ff 0%, #fff6fb 48%, #f7f9ff 100%)",headerBg:"linear-gradient(145deg, rgba(255,255,255,0.78), rgba(232,244,255,0.58))",cardBg:"linear-gradient(150deg, rgba(255,255,255,0.74), rgba(238,248,255,0.42))",cardBorder:"rgba(214,236,255,0.92)",cardShadow:"inset 0 1px 0 rgba(255,255,255,0.95), 0 14px 34px rgba(56,74,112,0.18), 0 6px 12px rgba(255,255,255,0.42)",mutedCardBg:"linear-gradient(160deg, rgba(255,255,255,0.66), rgba(234,246,255,0.48))"}},J={records:[],accentColor:h.period,panelStyle:"soft",showChibi:!0,periodChibiSize:168},is=Object.assign({"../../public/period-chibi/chibi-154.webp":tt,"../../public/period-chibi/chibi-156.webp":st,"../../public/period-chibi/chibi-158.webp":rt,"../../public/period-chibi/chibi-183.webp":it,"../../public/period-chibi/chibi-184.webp":nt,"../../public/period-chibi/chibi-185.webp":ot,"../../public/period-chibi/chibi-186.webp":at,"../../public/period-chibi/chibi-187.webp":ct,"../../public/period-chibi/chibi-188.webp":lt,"../../public/period-chibi/chibi-189.webp":dt,"../../public/period-chibi/chibi-190.webp":bt,"../../public/period-chibi/chibi-191.webp":pt,"../../public/period-chibi/chibi-192.webp":ut,"../../public/period-chibi/chibi-193.webp":ht,"../../public/period-chibi/chibi-194.webp":xt,"../../public/period-chibi/chibi-195.webp":ft,"../../public/period-chibi/chibi-196.webp":gt,"../../public/period-chibi/chibi-197.webp":mt,"../../public/period-chibi/chibi-198.webp":_t,"../../public/period-chibi/chibi-199.webp":vt,"../../public/period-chibi/chibi-200.webp":yt,"../../public/period-chibi/chibi-201.webp":wt,"../../public/period-chibi/chibi-202.webp":jt,"../../public/period-chibi/chibi-203.webp":Nt,"../../public/period-chibi/chibi-204.webp":St,"../../public/period-chibi/chibi-205.webp":kt,"../../public/period-chibi/chibi-206.webp":Dt,"../../public/period-chibi/chibi-207.webp":Ct,"../../public/period-chibi/chibi-208.webp":Ot,"../../public/period-chibi/chibi-209.webp":Et,"../../public/period-chibi/chibi-210.webp":Mt,"../../public/period-chibi/chibi-211.webp":Pt,"../../public/period-chibi/chibi-212.webp":Bt,"../../public/period-chibi/chibi-213.webp":At,"../../public/period-chibi/chibi-214.webp":Tt,"../../public/period-chibi/chibi-215.webp":Rt,"../../public/period-chibi/chibi-216.webp":It,"../../public/period-chibi/chibi-217.webp":$t,"../../public/period-chibi/chibi-218.webp":zt,"../../public/period-chibi/chibi-219.webp":Ft,"../../public/period-chibi/chibi-220.webp":Yt,"../../public/period-chibi/chibi-221.webp":Lt,"../../public/period-chibi/chibi-248.webp":Ht,"../../public/period-chibi/chibi-291.webp":Jt,"../../public/period-chibi/chibi-292.webp":Ut,"../../public/period-chibi/chibi-293.webp":Kt,"../../public/period-chibi/chibi-294.webp":Wt,"../../public/period-chibi/chibi-295.webp":Gt,"../../public/period-chibi/chibi-296.webp":Qt,"../../public/period-chibi/chibi-297.webp":Vt,"../../public/period-chibi/chibi-298.webp":Zt,"../../public/period-chibi/chibi-300.webp":qt}),ns=Object.entries(is).sort(([t],[r])=>t.localeCompare(r)).map(([,t])=>t);function N(t){const r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${r}-${i}-${n}`}function m(t){const r=t.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!r)return null;const[,i,n,c]=r.map(Number),l=new Date(i,n-1,c);return l.getFullYear()!==i||l.getMonth()!==n-1||l.getDate()!==c?null:l}function A(t,r){const i=new Date(t);return i.setDate(i.getDate()+r),i}function C(t,r){const i=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),n=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();return Math.round((n-i)/864e5)}function Q(t,r,i){return Math.min(i,Math.max(r,t))}function je(t){return t.length?t[Math.floor(Math.random()*t.length)]:null}function os(t){let r=2166136261;for(let i=0;i<t.length;i+=1)r^=t.charCodeAt(i),r=Math.imul(r,16777619);return r>>>0}function z(t,r){if(!t.length)return null;const i=os(r)%t.length;return t[i]}function as(t){return`${t.getFullYear()}å¹´ ${t.getMonth()+1}æœˆ`}function cs(t){const r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0");return`${r}-${i}`}function ls(t){const r=t.match(/^(\d{4})-(\d{2})$/);if(!r)return null;const i=Number(r[1]),n=Number(r[2]);return!Number.isInteger(i)||!Number.isInteger(n)||n<1||n>12?null:new Date(i,n-1,1)}function Ne(t){const r=m(t);if(!r)return"MM/DD";const i=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${i}/${n}`}function G(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}function ue(t){if(!Array.isArray(t))return[];const r=[],i=new Set;return t.forEach((n,c)=>{if(!G(n))return;const l=typeof n.startDate=="string"?n.startDate:"",b=typeof n.endDate=="string"?n.endDate:"",d=typeof n.note=="string"?n.note:"",v=typeof n.createdAt=="string"&&n.createdAt.trim()?n.createdAt:new Date().toISOString(),k=m(l),x=m(b);if(!k||!x||C(k,x)<0)return;const w=typeof n.id=="string"&&n.id.trim()?n.id:`${l}-${v}-${c}`;i.has(w)||(i.add(w),r.push({id:w,startDate:l,endDate:b,note:d,createdAt:v}))}),r.sort((n,c)=>n.startDate.localeCompare(c.startDate))}function Oe(t){if(!G(t))return J;const r=typeof t.accentColor=="string"&&t.accentColor.trim()?t.accentColor:J.accentColor,i=t.panelStyle==="glass"||t.panelStyle==="minimal"||t.panelStyle==="soft"?t.panelStyle:J.panelStyle,n=t.showChibi!==!1,c=typeof t.periodChibiSize=="number"&&Number.isFinite(t.periodChibiSize)?Q(t.periodChibiSize,120,220):J.periodChibiSize;return{records:ue(t.records),accentColor:r,panelStyle:i,showChibi:n,periodChibiSize:c}}function ds(){try{const t=window.localStorage.getItem(De);if(!t)return J;const r=JSON.parse(t);return Oe(r)}catch{return J}}function bs(t){return ue(t)}function Se(t){if(!Array.isArray(t))return[];const r=new Set;return t.forEach(i=>{typeof i!="string"||!m(i)||r.has(i)||r.add(i)}),Array.from(r)}function ps(t,r){const i=ue([...t.records,...r.records]);return{...t,records:i}}function us(t,r){const i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),n=URL.createObjectURL(i),c=document.createElement("a");c.href=n,c.download=t,c.click(),URL.revokeObjectURL(n)}function hs(t){const r=bs(t);if(!r.length)return{completed:r,avgCycleLength:28,avgDuration:5,nextStartKey:"",nextEndKey:"",predictedStarts:[]};const i=r.map(x=>{const w=m(x.startDate),E=m(x.endDate);return C(w,E)+1}),n=Q(Math.round(i.reduce((x,w)=>x+w,0)/i.length),3,10),c=[];for(let x=1;x<r.length;x++){const w=m(r[x-1].startDate),E=m(r[x].startDate),M=C(w,E);M>=15&&M<=60&&c.push(M)}const l=c.length?Q(Math.round(c.reduce((x,w)=>x+w,0)/c.length),21,40):28,b=m(r[r.length-1].startDate),d=[];for(let x=1;x<=6;x++)d.push(N(A(b,l*x)));const v=A(b,l),k=A(v,n-1);return{completed:r,avgCycleLength:l,avgDuration:n,nextStartKey:N(v),nextEndKey:N(k),predictedStarts:d}}function xs(t){const r=t.getFullYear(),i=t.getMonth(),n=new Date(r,i,1),c=n.getDay(),l=new Date(r,i+1,0).getDate(),b=[];for(let d=c;d>0;d--){const v=A(n,-d);b.push({key:N(v),day:v.getDate(),inMonth:!1})}for(let d=1;d<=l;d++){const v=new Date(r,i,d);b.push({key:N(v),day:d,inMonth:!0})}for(;b.length%7!==0;){const d=A(m(b[b.length-1].key),1);b.push({key:N(d),day:d.getDate(),inMonth:!1})}return b}function fs(t){const r=c=>c.replace(/\/n/g,`
`).replace(/\\n/g,`
`).trim();if(Array.isArray(t)){const c=t.filter(l=>typeof l=="string").map(r).filter(l=>l.length>0);return c.length?{...pe,period:c}:null}if(!t||typeof t!="object")return null;const i=t,n={...pe};for(const c of Object.keys(n)){const l=i[c];if(!Array.isArray(l))continue;const b=l.filter(d=>typeof d=="string").map(r).filter(d=>d.length>0);b.length&&(n[c]=b)}return n}function gs(t){if(!t||typeof t!="object")return null;const r=c=>c.replace(/\/n/g,`
`).replace(/\\n/g,`
`).trim(),i=t,n={...Ce};for(const c of Object.keys(n)){const l=i[c];if(!Array.isArray(l))continue;const b=l.filter(d=>typeof d=="string").map(r).filter(d=>d.length>0);b.length&&(n[c]=b)}return n}function ms(t){const r=i=>i.replace(/\/n/g,`
`).replace(/\\n/g,`
`).trim();if(Array.isArray(t))return t.filter(i=>typeof i=="string").map(r).filter(i=>i.length>0);if(t&&typeof t=="object"){const i=t.phrases;if(Array.isArray(i))return i.filter(n=>typeof n=="string").map(r).filter(n=>n.length>0)}return[]}function re(){try{const t=window.localStorage.getItem(ie);if(!t)return new Set;const r=JSON.parse(t);if(!Array.isArray(r))return new Set;const i=r.filter(n=>typeof n=="string"&&!!m(n));return new Set(i)}catch{return new Set}}function ke(t){const r=re();r.has(t)||(r.add(t),window.localStorage.setItem(ie,JSON.stringify(Array.from(r))))}function _s(t,r,i,n,c,l){const b=m(t);if(!b)return z(l.safe,`period-safe:${t}`)??"";if(r.has(t))return z(l.period,`period-actual:${t}`)??"";if(i){const d=m(i);if(d){const v=C(b,d);if(v>=1&&v<=3)return z(l.prePeriod,`period-pre:${t}`)??""}}return n&&c&&t>=n&&t<=c?z(l.ovulation,`period-ovul:${t}`)??"":z(l.safe,`period-safe:${t}`)??""}function vs(t){return t==="ç¶“æœŸä¸­"?"menstrual":t==="ç¶“å‰æœŸ"?"pms":t==="æ’åµçª—"?"ovulation":"recovery"}function ys({phrase:t}){return e.jsxs("div",{className:"relative max-w-[11.5rem] rounded-2xl bg-white px-3 py-2.5",style:{boxShadow:"0 4px 16px rgba(0,0,0,0.12)"},children:[e.jsx("p",{className:"text-[12px] leading-snug text-stone-600",children:t}),e.jsx("div",{className:"absolute -bottom-[7px] right-5",style:{width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent",borderTop:"7px solid white"}})]})}function ws({chibiSrc:t,phrase:r,sizePx:i,onClickSettings:n}){const c=Q(i,120,220),l=Math.round(c*.86);return e.jsxs("div",{className:"pointer-events-none absolute bottom-[42px] right-2 z-20 flex flex-col items-end gap-2 sm:right-3",children:[e.jsx("div",{className:"pointer-events-auto",children:e.jsx(ys,{phrase:r})}),e.jsx("button",{type:"button",onClick:n,className:"pointer-events-auto transition active:scale-90","aria-label":"é¢æ¿é¢¨æ ¼",children:t?e.jsx("img",{src:t,alt:"",draggable:!1,className:"select-none drop-shadow-md",style:{width:c,height:"auto"}}):e.jsx("div",{className:"flex items-center justify-center rounded-2xl text-4xl drop-shadow-md",style:{width:c,height:l,background:"linear-gradient(145deg,#fde9d7,#f0ddd0)"},children:"ğŸ§¸"})})]})}function js({dateKey:t,isActual:r,phrase:i,onMarkStart:n,onMarkEnd:c,onClear:l,onClose:b}){const d=m(t),v=d?C(new Date,d):0,k=v===0?"ä»Šå¤©":v>0?`è·ä»Š ${v} å¤©å¾Œ`:`${Math.abs(v)} å¤©å‰`,x=t.split("-"),w=x.length===3?`${x[0]} / ${x[1]} / ${x[2]}`:t;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 z-30 rounded-[44px]",style:{background:"rgba(0,0,0,0.28)"},onClick:b}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-40 rounded-t-3xl px-5 pb-8 pt-3.5",style:{background:"white",boxShadow:"0 -6px 28px rgba(0,0,0,0.12)"},children:[e.jsx("div",{className:"mx-auto mb-4 h-1 w-9 rounded-full bg-stone-300"}),e.jsxs("div",{className:"mb-5 border-b pb-4 text-center",style:{borderColor:"#f4f3f2"},children:[e.jsx("p",{className:"mb-1 text-[11px] uppercase tracking-[0.12em] text-stone-400",children:"é¸æ“‡çš„æ—¥æœŸ"}),e.jsx("p",{className:"text-[22px] font-bold tracking-[-0.5px]",style:{color:h.today},children:w}),e.jsx("p",{className:"mt-1 text-[11px] text-stone-400",children:k}),!!i&&e.jsxs("p",{className:"mt-2 text-[11px] italic text-stone-400",children:["ã€Œ",i,"ã€"]})]}),e.jsx("button",{type:"button",onClick:n,className:"mb-2 w-full rounded-2xl border p-3 text-left text-sm font-medium transition active:scale-[0.98]",style:{background:"#fde4ec",color:h.accent,borderColor:"rgba(212,96,122,0.18)"},children:"ğŸ©¸ è¨˜éŒ„ç‚ºæœˆç¶“é–‹å§‹æ—¥"}),e.jsx("button",{type:"button",onClick:c,className:"mb-2 w-full rounded-2xl p-3 text-left text-sm transition active:scale-[0.98]",style:{background:"#f5f5f4",color:"#44403c"},children:"âœ“ è¨˜éŒ„ç‚ºæœˆç¶“çµæŸæ—¥"}),r&&e.jsx("button",{type:"button",onClick:l,className:"mb-2 w-full rounded-2xl border p-3 text-left text-sm transition active:scale-[0.98]",style:{background:"white",color:"#b8b0a8",borderColor:"#e7e5e4"},children:"ğŸ—‘ï¸ æ¸…é™¤æ­¤æ—¥æœŸçš„æ¨™è¨˜"}),e.jsx("button",{type:"button",onClick:b,className:"w-full rounded-2xl p-3 text-sm text-stone-400 transition active:scale-[0.98]",children:"å–æ¶ˆ"})]})]})}function Ns({panelStyle:t,onPanelStyleChange:r,showChibi:i,onToggleChibi:n,chibiSize:c,onChibiSizeChange:l,backupBusy:b,backupStatus:d,onExportBackup:v,onImportBackup:k,onClearAll:x,onClose:w}){const[E,M]=u.useState({style:!1,chibi:!1,backup:!1,danger:!1});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 z-30 rounded-[44px]",style:{background:"rgba(0,0,0,0.28)"},onClick:w}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-40 rounded-t-3xl px-5 pb-10 pt-3.5",style:{background:"white",boxShadow:"0 -6px 28px rgba(0,0,0,0.12)"},children:[e.jsx("div",{className:"mx-auto mb-5 h-1 w-9 rounded-full bg-stone-300"}),e.jsx("p",{className:"mb-5 text-center text-base font-semibold text-stone-800",children:"é¢æ¿é¢¨æ ¼"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(se,{title:"é¢æ¿é¢¨æ ¼",subtitle:"ç¸½è¦½å¡ç‰‡è¦–è¦º",isOpen:E.style,onToggle:()=>M(f=>({...f,style:!f.style})),className:"rounded-2xl bg-stone-50 p-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ss.map(f=>{const _=f.id===t;return e.jsx("button",{type:"button",onClick:()=>r(f.id),className:"rounded-xl border px-2 py-2 text-xs transition active:scale-95",style:{background:_?"#fde4ec":"#fff",color:_?h.accent:"#57534e",borderColor:_?"rgba(212,96,122,0.24)":"#e7e5e4",fontWeight:_?600:400},children:f.label},f.id)})}),e.jsx("p",{className:"mt-2 text-[10px] text-stone-400",children:"çµ±è¨ˆè³‡è¨Šåœ¨ã€Œç¸½è¦½ã€é æŸ¥çœ‹ã€‚"})]}),e.jsxs(se,{title:"M",subtitle:"é¡¯ç¤ºèˆ‡å¤§å°",isOpen:E.chibi,onToggle:()=>M(f=>({...f,chibi:!f.chibi})),className:"rounded-2xl bg-stone-50 p-4",children:[e.jsxs("div",{className:"mb-2.5 flex items-center justify-between gap-3 rounded-xl border border-stone-200 bg-white px-3 py-2.5",children:[e.jsx("p",{className:"text-xs text-stone-600",children:"M"}),e.jsx("button",{type:"button",onClick:n,className:"relative h-6 w-10 rounded-full transition",style:{background:i?"#8a6a4e":"#bcb7b0"},"aria-label":"åˆ‡æ›Mé¡¯ç¤º",children:e.jsx("span",{className:"absolute top-0.5 h-5 w-5 rounded-full bg-white shadow-sm transition-all",style:{left:i?18:2}})})]}),e.jsx("input",{type:"range",min:120,max:220,step:1,value:c,onChange:f=>l(Number(f.target.value)),className:"w-full accent-stone-700"})]}),e.jsxs(se,{title:"è³‡æ–™å‚™ä»½",subtitle:"åŒ¯å‡ºã€åˆä½µåŒ¯å…¥ã€è¦†è“‹åŒ¯å…¥",isOpen:E.backup,onToggle:()=>M(f=>({...f,backup:!f.backup})),className:"rounded-2xl bg-stone-50 p-4",children:[e.jsx("button",{type:"button",onClick:v,disabled:b,className:"mb-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-left transition active:scale-[0.98] disabled:cursor-not-allowed disabled:opacity-50",children:e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 text-center text-lg",children:"ğŸ“¤"}),e.jsxs("span",{className:"flex-1",children:[e.jsx("span",{className:"block text-sm text-stone-700",children:"åŒ¯å‡ºå‚™ä»½"}),e.jsx("span",{className:"block text-[10.5px] text-stone-400",children:"ä¸‹è¼‰ JSONï¼ˆå¯å›å¾©ï¼‰"})]})]})}),e.jsxs("label",{className:"mb-2 block w-full cursor-pointer rounded-xl border border-stone-200 bg-white px-4 py-3 transition active:scale-[0.98]",children:[e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 text-center text-lg",children:"ğŸ“¥"}),e.jsxs("span",{className:"flex-1",children:[e.jsx("span",{className:"block text-sm text-stone-700",children:"åŒ¯å…¥å‚™ä»½ï¼ˆåˆä½µï¼‰"}),e.jsx("span",{className:"block text-[10.5px] text-stone-400",children:"ä¿ç•™ç¾æœ‰è³‡æ–™ï¼ŒåŠ å…¥æ–°è³‡æ–™"})]})]}),e.jsx("input",{type:"file",accept:".json,application/json",className:"hidden",disabled:b,onChange:f=>{const _=f.target.files?.[0];f.currentTarget.value="",_&&k("merge",_)}})]}),e.jsxs("label",{className:"block w-full cursor-pointer rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 transition active:scale-[0.98]",children:[e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 text-center text-lg",children:"â™»ï¸"}),e.jsxs("span",{className:"flex-1",children:[e.jsx("span",{className:"block text-sm text-rose-700",children:"åŒ¯å…¥å‚™ä»½ï¼ˆè¦†è“‹ï¼‰"}),e.jsx("span",{className:"block text-[10.5px] text-rose-400",children:"ç”¨å‚™ä»½å…§å®¹ç›´æ¥å–ä»£ç›®å‰è³‡æ–™"})]})]}),e.jsx("input",{type:"file",accept:".json,application/json",className:"hidden",disabled:b,onChange:f=>{const _=f.target.files?.[0];f.currentTarget.value="",_&&k("overwrite",_)}})]}),d&&e.jsx("p",{className:"mt-2 text-xs text-stone-500",children:d})]}),e.jsx(se,{title:"è³‡æ–™æ¸…ç†",subtitle:"å±éšªæ“ä½œ",isOpen:E.danger,onToggle:()=>M(f=>({...f,danger:!f.danger})),className:"rounded-2xl bg-stone-50 p-4",children:e.jsx("button",{type:"button",onClick:x,className:"w-full rounded-2xl border p-3 text-sm transition active:scale-[0.98]",style:{background:"white",color:"#b8b0a8",borderColor:"#e7e5e4"},children:"ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰ç´€éŒ„"})})]}),e.jsx("button",{type:"button",onClick:w,className:"mt-2 w-full rounded-2xl p-3 text-sm text-stone-400 transition active:scale-[0.98]",children:"é—œé–‰"})]})]})}function Ds({onExit:t=()=>{}}){const[r,i]=u.useState(ds),[n,c]=u.useState("overview"),[l,b]=u.useState(()=>new Date),[d,v]=u.useState(""),[k,x]=u.useState(""),[w,E]=u.useState(""),[M,f]=u.useState(""),[_,F]=u.useState(null),[he,U]=u.useState(!1),[ne,V]=u.useState(!1),[Ee,Y]=u.useState(""),[xe,Me]=u.useState(pe),[fe,Pe]=u.useState(Ce),[oe,Be]=u.useState(es),[P,ae]=u.useState(null),Z=ns,q=u.useRef(null),R=rs[r.panelStyle],ce=r.panelStyle==="glass"?{backdropFilter:"blur(16px) saturate(145%)",WebkitBackdropFilter:"blur(16px) saturate(145%)"}:r.panelStyle==="minimal"?{backdropFilter:"blur(12px) saturate(165%)",WebkitBackdropFilter:"blur(12px) saturate(165%)"}:{},K={background:R.cardBg,borderColor:R.cardBorder,boxShadow:R.cardShadow,...ce},X={background:R.mutedCardBg,borderColor:R.cardBorder,...ce},T=new Date,y=N(T),ee=u.useMemo(()=>z(Z,`period-chibi:${y}`)??"",[Z,y]),ge=!r.showChibi||!ee,Ae=cs(l),Te=u.useMemo(()=>xs(l),[l]);function Re(s){const o=ls(s);o&&(b(o),F(null))}u.useEffect(()=>{window.localStorage.setItem(De,JSON.stringify(r))},[r]),u.useEffect(()=>{let s=!0;const p=`${"/Our-love/docs/".replace(/\/?$/,"/")}data/period/period_hover_phrases.json`;return fetch(p).then(a=>a.ok?a.json():null).then(a=>{if(!s||!a)return;const g=fs(a);g&&Me(g)}).catch(()=>{}),()=>{s=!1}},[]),u.useEffect(()=>{let s=!0;const p=`${"/Our-love/docs/".replace(/\/?$/,"/")}data/period/period_post_end_phrases.json`;return fetch(p).then(a=>a.ok?a.json():null).then(a=>{if(!s||!a)return;const g=ms(a);g.length&&Be(g)}).catch(()=>{}),()=>{s=!1}},[]),u.useEffect(()=>{let s=!0;const p=`${"/Our-love/docs/".replace(/\/?$/,"/")}data/period/period_chibi_phrases.json`;return fetch(p).then(a=>a.ok?a.json():null).then(a=>{if(!s||!a)return;const g=gs(a);g&&Pe(g)}).catch(()=>{}),()=>{s=!1}},[]);const{completed:D,avgCycleLength:Ie,avgDuration:le,nextStartKey:B,predictedStarts:me}=u.useMemo(()=>hs(r.records),[r.records]),L=u.useMemo(()=>{const s=new Set;for(const o of D){const p=m(o.startDate),a=m(o.endDate);for(let g=0;g<=C(p,a);g++)s.add(N(A(p,g)))}return s},[D]),$e=u.useMemo(()=>{const s=new Set;for(const o of me){const p=m(o);if(p)for(let a=0;a<le;a++)s.add(N(A(p,a)))}return s},[le,me]),j=u.useMemo(()=>{if(!B)return{start:"",end:"",peak:""};const s=m(B);if(!s)return{start:"",end:"",peak:""};const o=A(s,-14);return{start:N(A(o,-2)),end:N(A(o,2)),peak:N(o)}},[B]),de=u.useMemo(()=>{if(L.has(y))return"ç¶“æœŸä¸­";if(B){const s=m(B);if(s&&C(T,s)>=1&&C(T,s)<=3)return"ç¶“å‰æœŸ"}return j.start&&j.end&&y>=j.start&&y<=j.end?"æ’åµçª—":"å¹³ç©©æœŸ"},[L,B,j,T,y]),H=u.useMemo(()=>{const s=m(B);return s?C(T,s):null},[B,T]),ze=u.useMemo(()=>{const s=vs(de);return z(fe[s],`period-chibi-phrase:${y}:${s}`)??""},[fe,y,de]);u.useEffect(()=>{if(!D.length||P||!oe.length)return;const s=re(),o=D.map(g=>g.endDate).filter(g=>g<=y&&!s.has(g)).sort().at(-1);if(!o)return;const p=je(oe)??"",a=je(Z)??ee;!p||!a||ae({endDate:o,text:p,chibiUrl:a})},[Z,ee,D,oe,P,y]),u.useEffect(()=>{if(!P)return;const s=window.setTimeout(()=>{ke(P.endDate),ae(null)},4500);return()=>window.clearTimeout(s)},[P]);const W=u.useMemo(()=>{if(!_)return null;const s=D.find(o=>_>=o.startDate&&_<=o.endDate);return{dateKey:_,isActual:L.has(_),isFuture:_>y,note:s?.note??"",matchedRecord:s,phrase:_s(_,L,B,j.start,j.end,xe)}},[L,D,xe,B,j,_,y]);function Fe(){const s=m(d),o=m(k);if(!s||!o){f("è«‹å…ˆé¸æ“‡é–‹å§‹æ—¥å’ŒçµæŸæ—¥ã€‚"),te({kind:"error",message:"ç¶“æœŸç´€éŒ„å„²å­˜å¤±æ•—ï¼šæ—¥æœŸä¸å®Œæ•´"});return}if(C(s,o)<0){f("çµæŸæ—¥ä¸èƒ½æ—©æ–¼é–‹å§‹æ—¥ã€‚"),te({kind:"error",message:"ç¶“æœŸç´€éŒ„å„²å­˜å¤±æ•—ï¼šçµæŸæ—¥æ—©æ–¼é–‹å§‹æ—¥"});return}if(N(o)>y){f("çµæŸæ—¥ä¸èƒ½è¶…éä»Šå¤©ã€‚"),te({kind:"error",message:"ç¶“æœŸç´€éŒ„å„²å­˜å¤±æ•—ï¼šçµæŸæ—¥è¶…éä»Šå¤©"});return}const p={id:`${N(s)}-${Date.now()}`,startDate:N(s),endDate:N(o),note:w.trim(),createdAt:new Date().toISOString()};i(a=>({...a,records:[...a.records,p]})),f("å·²å„²å­˜é€™æ¬¡ç¶“æœŸç´€éŒ„ã€‚"),te({kind:"success",message:"ç¶“æœŸç´€éŒ„å·²å„²å­˜"}),E(""),v(""),x("")}function _e(s){i(o=>({...o,records:o.records.filter(p=>p.id!==s)}))}function Ye(){if(!ne){V(!0),Y("åŒ¯å‡ºä¸­â€¦");try{const s=Array.from(re()),o={kind:ye,version:we,exportedAt:new Date().toISOString(),store:r,seenPostEndDates:s},p=new Date().toISOString().slice(0,10);us(`period-backup-${p}.json`,o),Y(`å·²åŒ¯å‡ºï¼š${r.records.length} ç­†ç´€éŒ„`)}catch{Y("åŒ¯å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œé‡è©¦")}finally{V(!1)}}}async function Le(s,o){if(!ne){V(!0),Y(s==="overwrite"?"è¦†è“‹åŒ¯å…¥ä¸­â€¦":"åˆä½µåŒ¯å…¥ä¸­â€¦");try{const p=await o.text(),a=JSON.parse(p);let g=null,$=[];if(G(a)&&a.kind===ye&&a.version===we)g=a.store,$=a.seenPostEndDates;else if(G(a)&&a.kind==="memorial-big-backup-part"&&a.domain==="aboutMe"&&a.part==="period")g=a.store,$=a.seenPostEndDates;else if(G(a)&&Array.isArray(a.records))g=a;else throw new Error("invalid");const O=Oe(g),S=Se($);if(s==="overwrite")i(O),window.localStorage.setItem(ie,JSON.stringify(S));else{i(et=>ps(et,O));const qe=Array.from(re()),Xe=Se([...qe,...S]);window.localStorage.setItem(ie,JSON.stringify(Xe))}Y(s==="overwrite"?`è¦†è“‹åŒ¯å…¥å®Œæˆï¼š${O.records.length} ç­†ç´€éŒ„`:`åˆä½µåŒ¯å…¥å®Œæˆï¼š${O.records.length} ç­†æ–°è³‡æ–™`)}catch{Y("åŒ¯å…¥å¤±æ•—ï¼šè«‹ç¢ºèª JSON ä¾†æºæ­£ç¢º")}finally{V(!1)}}}function He(){i(s=>({...s,records:[]})),U(!1)}function Je(){_&&(v(_),c("records"),F(null))}function Ue(){_&&(x(_),c("records"),F(null))}function Ke(){!_||!W?.matchedRecord||(_e(W.matchedRecord.id),F(null))}function ve(){P&&ke(P.endDate),ae(null)}function We(s,o){const p=Math.abs(s),a=Math.abs(o);if(p<ts||p<=a||_||he||P)return;if(n==="calendar"){s<0?b(S=>new Date(S.getFullYear(),S.getMonth()+1,1)):b(S=>new Date(S.getFullYear(),S.getMonth()-1,1));return}const g=be.indexOf(n);if(g<0)return;const $=s<0?1:-1,O=Math.max(0,Math.min(be.length-1,g+$));O!==g&&c(be[O])}function Ge(s){const o=s.changedTouches[0];o&&(q.current={x:o.clientX,y:o.clientY})}function Qe(s){const o=q.current;q.current=null;const p=s.changedTouches[0];!o||!p||We(p.clientX-o.x,p.clientY-o.y)}function Ve(){q.current=null}const I=D[D.length-1]??null,Ze=[{id:"overview",label:"ç¸½è¦½"},{id:"calendar",label:"æœˆæ›†"},{id:"records",label:"ç´€éŒ„"}];return e.jsxs("div",{className:"relative flex h-full flex-col overflow-hidden",style:{background:R.pageBg},children:[e.jsxs("header",{className:"shrink-0 border-b",style:{background:R.headerBg,borderColor:"rgba(0,0,0,0.06)",...ce},children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pb-2.5 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"grid h-8 w-8 place-items-center rounded-full border border-stone-300 bg-white/80 text-[22px] leading-none text-stone-600 transition active:scale-95",children:"â€¹"}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("p",{className:"text-[9px] uppercase tracking-[0.28em] text-stone-400",children:"PERIOD"}),e.jsx("h1",{className:"mt-0.5 leading-tight text-stone-800",style:{fontSize:"var(--ui-header-title-size, 17px)",fontFamily:"var(--app-font-family, -apple-system, 'Helvetica Neue', system-ui, sans-serif)"},children:"ç¶“æœŸè¿½è¹¤"})]}),ge?e.jsx("button",{type:"button",onClick:()=>U(!0),className:"grid h-8 w-8 place-items-center text-[22px] leading-none text-stone-400 transition active:opacity-60","aria-label":"æ›´å¤šè¨­å®š",children:"â‹¯"}):e.jsx("div",{className:"w-10"})]}),e.jsx("div",{className:"flex border-t",style:{borderColor:"rgba(0,0,0,0.06)"},children:Ze.map(s=>e.jsx("button",{type:"button",onClick:()=>c(s.id),className:"flex-1 border-b-2 transition",style:{padding:"9px 0 7px",fontSize:"var(--ui-tab-label-size, 17px)",lineHeight:1.2,fontWeight:500,letterSpacing:"0.04em",color:n===s.id?h.accent:"#a8a29e",borderBottomColor:n===s.id?h.accent:"transparent",fontFamily:"var(--app-font-family, -apple-system, 'Helvetica Neue', system-ui, sans-serif)"},children:s.label},s.id))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",onTouchStart:Ge,onTouchEnd:Qe,onTouchCancel:Ve,children:[n==="overview"&&e.jsxs("div",{className:"flex flex-col gap-3 px-4 pb-56 pt-4",children:[e.jsxs("div",{className:"rounded-3xl border p-5",style:{background:"linear-gradient(140deg,#fde6ec 0%,#fdf3f0 60%,#fdf7f4 100%)",borderColor:"rgba(212,96,122,0.12)",boxShadow:"0 6px 24px rgba(212,96,122,0.10)"},children:[e.jsx("p",{className:"mb-1.5 text-[10px] font-medium uppercase tracking-[0.14em]",style:{color:h.accentMid},children:de}),H!==null?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-[52px] font-black leading-none tracking-[-2px]",style:{color:h.today},children:Math.abs(H)}),e.jsx("p",{className:"mt-1 text-sm",style:{color:"#78716c"},children:H<0?`è¶…éé æ¸¬ ${Math.abs(H)} å¤©`:H===0?"ä»Šå¤©æ˜¯é æ¸¬é–‹å§‹æ—¥":`è·ä¸‹æ¬¡æœˆç¶“é‚„æœ‰ ${H} å¤©`}),e.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 rounded-xl px-3 py-2",style:{background:"rgba(229,115,138,0.12)"},children:[e.jsx("span",{className:"text-[10px]",style:{color:h.accentMid},children:"é æ¸¬ä¸‹æ¬¡"}),e.jsx("span",{className:"text-sm font-bold",style:{color:h.period},children:B.slice(5).replace("-","/")})]})]}):e.jsx("p",{className:"mt-2 text-sm text-stone-500",children:"æ–°å¢ç¬¬ä¸€ç­†ç´€éŒ„å¾Œæœƒè‡ªå‹•é æ¸¬"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{label:"å¹³å‡é€±æœŸ",value:`${Ie}`,hint:"å¤©"},{label:"å¹³å‡ç¶“æœŸ",value:`${le}`,hint:"å¤©"},{label:"ç´€éŒ„æ•¸é‡",value:`${D.length}`,hint:"ç­†"}].map(s=>e.jsxs("div",{className:"rounded-2xl border px-2 py-3 text-center",style:K,children:[e.jsx("span",{className:"block text-[8px] uppercase tracking-[0.1em] text-stone-400 mb-1",children:s.label}),e.jsx("span",{className:"block text-lg font-bold text-stone-800",children:s.value}),e.jsx("span",{className:"block text-[9px] text-stone-400 mt-0.5",children:s.hint})]},s.label))}),I&&e.jsxs("div",{className:"rounded-2xl border p-4",style:K,children:[e.jsx("span",{className:"mb-2 block text-[9px] uppercase tracking-[0.14em] text-stone-400",children:"ä¸Šæ¬¡æœˆç¶“"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-stone-700",children:[I.startDate.slice(5).replace("-","/")," â€” ",I.endDate.slice(5).replace("-","/")]}),e.jsxs("p",{className:"mt-0.5 text-[10px] text-stone-400",children:["å…± ",C(m(I.startDate),m(I.endDate))+1," å¤©"]})]}),e.jsxs("div",{className:"rounded-full px-3 py-1 text-xs font-medium",style:{background:"#fde4ec",color:h.period},children:[C(m(I.startDate),m(I.endDate))+1," å¤©"]})]})]}),j.start&&e.jsxs("div",{className:"rounded-2xl border p-4",style:{background:r.panelStyle==="soft"?"rgba(197,232,212,0.35)":"linear-gradient(145deg, rgba(226,246,237,0.82), rgba(201,236,224,0.48))",borderColor:r.panelStyle==="soft"?"rgba(42,96,72,0.10)":"rgba(42,96,72,0.17)"},children:[e.jsx("span",{className:"mb-2 block text-[9px] uppercase tracking-[0.14em] text-stone-400",children:"é æ¸¬å¯å­•æœŸ"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",style:{color:h.fertileText},children:[j.start.slice(5).replace("-","/")," â€” ",j.end.slice(5).replace("-","/")]}),e.jsxs("p",{className:"mt-0.5 text-[10px] text-stone-400",children:["æ’åµæ—¥ ",j.peak.slice(5).replace("-","/"),"ï¼ˆé æ¸¬ï¼‰"]})]}),e.jsx("div",{className:"rounded-full px-3 py-1 text-xs font-medium",style:{background:h.fertile,color:h.fertileText},children:j.peak<=y?"å·²é":"å³å°‡"})]})]}),!D.length&&e.jsxs("div",{className:"rounded-2xl border p-5 text-center",style:X,children:[e.jsx("p",{className:"text-2xl mb-2",children:"ğŸ©¸"}),e.jsx("p",{className:"text-sm text-stone-500",children:"é‚„æ²’æœ‰ç´€éŒ„ï¼Œå»ã€Œç´€éŒ„ã€é æ–°å¢ç¬¬ä¸€ç­†å§ï¼"})]})]}),n==="calendar"&&e.jsxs("div",{className:"flex flex-col gap-3 px-4 pb-56 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{type:"button",onClick:()=>b(s=>new Date(s.getFullYear(),s.getMonth()-1,1)),className:"flex h-8 w-8 items-center justify-center rounded-full border text-sm text-stone-600 transition active:scale-90",style:{background:"rgba(255,255,255,0.85)",borderColor:"#e7e5e4"},children:"â€¹"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("label",{className:"relative flex cursor-pointer items-center gap-1 text-base font-semibold text-stone-800",children:[e.jsx("span",{children:as(l)}),e.jsx("span",{className:"text-xs text-stone-500",children:"â–¾"}),e.jsx("input",{type:"month",value:Ae,onChange:s=>Re(s.target.value),className:"absolute inset-0 h-full w-full cursor-pointer opacity-0","aria-label":"å¿«é€Ÿè·³åˆ°æŒ‡å®šæœˆä»½",title:"å¿«é€Ÿè·³åˆ°æŒ‡å®šæœˆä»½"})]}),e.jsx("button",{type:"button",onClick:()=>b(new Date(T.getFullYear(),T.getMonth(),1)),"aria-label":"å›åˆ°æœ¬æœˆ",title:"å›åˆ°æœ¬æœˆ",className:"text-xs text-stone-500 transition active:scale-95",children:"â†º"})]}),e.jsx("button",{type:"button",onClick:()=>b(s=>new Date(s.getFullYear(),s.getMonth()+1,1)),className:"flex h-8 w-8 items-center justify-center rounded-full border text-sm text-stone-600 transition active:scale-90",style:{background:"rgba(255,255,255,0.85)",borderColor:"#e7e5e4"},children:"â€º"})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Xt.map(s=>e.jsx("div",{className:"py-1 text-center text-[9px] text-stone-400",children:s},s)),Te.map(s=>{const o=s.key===y,p=L.has(s.key),a=!p&&$e.has(s.key),g=!p&&!a&&j.start&&j.end&&s.key>=j.start&&s.key<=j.end,$=s.key===j.peak;let O="",S="#44403c";return s.inMonth||(S="#d6d3d1"),p?(O=h.period,S="white"):a?(O=h.predicted,S="#bf6070"):g&&(O=h.fertile,S=h.fertileText),e.jsxs("div",{className:"relative flex aspect-square cursor-pointer items-center justify-center rounded-full text-xs transition active:scale-90",style:{background:O||void 0,color:S,fontWeight:o?700:void 0,outline:o?`2px solid ${h.today}`:void 0,outlineOffset:o?"1px":void 0},onClick:()=>s.inMonth&&F(s.key),children:[s.day,$&&e.jsx("span",{className:"absolute right-0.5 top-0.5 rounded-full border-[1.5px] border-white",style:{width:6,height:6,background:h.ovulation}})]},s.key)})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-3 rounded-2xl px-3 py-2.5",style:{...X,borderColor:"transparent"},children:[{bg:h.period,label:"æœˆç¶“"},{bg:h.predicted,label:"é æ¸¬"},{bg:h.fertile,label:"å¯å­•æœŸ"},{bg:h.ovulation,label:"æ’åµæ—¥",small:!0},{bg:"transparent",label:"ä»Šå¤©",outline:!0}].map(s=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"inline-block rounded-full",style:{width:s.small?7:9,height:s.small?7:9,background:s.bg,outline:s.outline?`2px solid ${h.today}`:void 0}}),e.jsx("span",{className:"text-[10px] text-stone-500",children:s.label})]},s.label))}),e.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border p-3",style:X,children:[e.jsx("span",{className:"text-[18px]",children:"ğŸ“…"}),e.jsx("p",{className:"flex-1 text-xs leading-relaxed text-stone-400",children:"é»æœˆæ›†æ—¥æœŸå¯è£œè¨˜æˆ–æ¨™è¨˜æœˆç¶“é–‹å§‹ï¼çµæŸæ—¥"})]})]}),n==="records"&&e.jsxs("div",{className:"flex flex-col gap-3 px-4 pb-56 pt-4",children:[e.jsxs("p",{className:"text-[10px] uppercase tracking-[0.14em] text-stone-400",children:["ä»Šå¤© Â· ",y.replace(/-/g," / ")]}),e.jsxs("div",{className:"rounded-2xl border p-4",style:K,children:[e.jsx("span",{className:"mb-2.5 block text-[9px] uppercase tracking-[0.14em] text-stone-400",children:"å¿«é€Ÿè¨˜éŒ„"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:()=>v(y),className:"rounded-2xl p-3.5 text-left text-sm font-medium text-white transition active:scale-[0.98]",style:{background:h.period,boxShadow:"0 4px 14px rgba(229,115,138,0.3)"},children:"ğŸ©¸ è¨˜éŒ„ä»Šå¤©æœˆç¶“é–‹å§‹"}),e.jsx("button",{type:"button",onClick:()=>x(y),className:"rounded-2xl border p-3.5 text-left text-sm font-medium transition active:scale-[0.98]",style:{background:"#fde4ec",color:h.accent,borderColor:"rgba(212,96,122,0.18)"},children:"âœ“ è¨˜éŒ„ä»Šå¤©æœˆç¶“çµæŸ"})]})]}),e.jsxs("div",{className:"rounded-2xl border p-4",style:K,children:[e.jsx("span",{className:"mb-2.5 block text-[9px] uppercase tracking-[0.14em] text-stone-400",children:"æ‰‹å‹•è¼¸å…¥"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-[11px] text-stone-500",children:"é–‹å§‹æ—¥"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-full rounded-xl border border-stone-300 bg-white/85 px-3 py-2 text-left text-sm text-stone-800",children:Ne(d)}),e.jsx("input",{type:"date",value:d,max:y,onChange:s=>v(s.target.value),className:"absolute inset-0 h-full w-full cursor-pointer opacity-0","aria-label":"é–‹å§‹æ—¥"})]})]}),e.jsxs("label",{className:"space-y-1",children:[e.jsx("span",{className:"text-[11px] text-stone-500",children:"çµæŸæ—¥"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-full rounded-xl border border-stone-300 bg-white/85 px-3 py-2 text-left text-sm text-stone-800",children:Ne(k)}),e.jsx("input",{type:"date",value:k,max:y,onChange:s=>x(s.target.value),className:"absolute inset-0 h-full w-full cursor-pointer opacity-0","aria-label":"çµæŸæ—¥"})]})]})]}),e.jsxs("label",{className:"block space-y-1 mb-3",children:[e.jsx("span",{className:"text-[11px] text-stone-500",children:"å‚™è¨»ï¼ˆé¸å¡«ï¼‰"}),e.jsx("textarea",{value:w,onChange:s=>E(s.target.value),rows:2,className:"w-full resize-none rounded-xl border border-stone-300 bg-white/85 px-3 py-2 text-sm text-stone-800",placeholder:"ä¾‹å¦‚ï¼šé€™æ¬¡æ¯”è¼ƒç–²ç´¯"})]}),e.jsx("button",{type:"button",onClick:Fe,className:"w-full rounded-2xl py-3 text-sm font-medium text-white transition active:scale-[0.98]",style:{background:h.period,boxShadow:"0 4px 14px rgba(229,115,138,0.25)"},children:"å„²å­˜é€™æ¬¡ç¶“æœŸ"}),!!M&&e.jsx("p",{className:"mt-2 text-center text-xs text-stone-500",children:M})]}),D.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"mb-2.5 text-[10px] uppercase tracking-[0.14em] text-stone-400",children:"æ­·å²ç´€éŒ„"}),e.jsx("div",{className:"rounded-2xl border px-4 py-1",style:K,children:D.slice().reverse().map(s=>{const o=C(m(s.startDate),m(s.endDate))+1;return e.jsxs("div",{className:"flex items-center gap-3 border-b py-3 last:border-b-0",style:{borderColor:"rgba(0,0,0,0.04)"},children:[e.jsx("div",{className:"h-2.5 w-2.5 shrink-0 rounded-full",style:{background:h.period}}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("p",{className:"text-[13px] text-stone-700",children:[s.startDate.slice(5).replace("-","/")," â€” ",s.endDate.slice(5).replace("-","/")]}),e.jsxs("p",{className:"mt-0.5 text-[10px] text-stone-400",children:["æŒçºŒ ",o," å¤©",s.note?` Â· ${s.note}`:""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-xs font-medium",style:{color:h.period},children:[o," å¤©"]}),e.jsx("button",{type:"button",onClick:()=>_e(s.id),className:"rounded-lg border px-2 py-1 text-[11px] text-stone-400 transition active:scale-95",style:{borderColor:"#e7e5e4",background:"white"},children:"åˆªé™¤"})]})]},s.id)})})]}),e.jsxs("button",{type:"button",onClick:()=>U(!0),className:"flex items-center gap-3 rounded-2xl border p-3 text-left transition active:scale-[0.98]",style:X,children:[e.jsx("span",{className:"text-[18px]",children:"âš™ï¸"}),e.jsx("p",{className:"flex-1 text-xs text-stone-400",children:"é¢æ¿é¢¨æ ¼ Â· æ¸…é™¤è³‡æ–™"}),e.jsx("span",{className:"text-stone-300",children:"â€º"})]})]})]}),n!=="records"&&!ge&&e.jsx(ws,{chibiSrc:ee,phrase:ze,sizePx:r.periodChibiSize,onClickSettings:()=>U(!0)}),P&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center px-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:ve}),e.jsxs("div",{className:"relative w-full max-w-sm rounded-2xl border border-stone-300 bg-white p-4 shadow-xl",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.14em] text-stone-500",children:"Period Update"}),e.jsx("button",{type:"button",onClick:ve,className:"rounded-lg border border-stone-300 px-2 py-1 text-xs text-stone-600",children:"é—œé–‰"})]}),e.jsx("p",{className:"text-lg text-stone-900",children:"æœ¬æ¬¡ç¶“æœŸçµæŸ"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3 rounded-xl border border-stone-200 bg-stone-50 p-3",children:[e.jsx("img",{src:P.chibiUrl,alt:"",draggable:!1,className:"h-16 w-16 shrink-0 object-contain"}),e.jsx("p",{className:"whitespace-pre-line text-sm text-stone-700",children:P.text})]})]})]}),_&&W&&e.jsx(js,{dateKey:_,isActual:W.isActual,phrase:W.phrase,onMarkStart:Je,onMarkEnd:Ue,onClear:Ke,onClose:()=>F(null)}),he&&e.jsx(Ns,{panelStyle:r.panelStyle,onPanelStyleChange:s=>i(o=>({...o,panelStyle:s})),showChibi:r.showChibi,onToggleChibi:()=>i(s=>({...s,showChibi:!s.showChibi})),chibiSize:r.periodChibiSize,onChibiSizeChange:s=>i(o=>({...o,periodChibiSize:Q(s,120,220)})),backupBusy:ne,backupStatus:Ee,onExportBackup:Ye,onImportBackup:(s,o)=>{Le(s,o)},onClearAll:He,onClose:()=>U(!1)})]})}export{Ds as PeriodPage};
